# ============================================================================
# ABSOLUTE PROHIBITION: --no-verify DETECTION IN COMMIT MESSAGES
# ============================================================================

commit_msg=$(cat "$1")

# Check commit message for any mention of --no-verify or bypass attempts
# Only flag actual bypass commands, not descriptions of the enforcement
if echo "$commit_msg" | grep -qiE "(git commit.*no-verify|--no-verify|--no-gpg-sign|skip hooks|SKIP_HOOKS|HUSKY_SKIP|BYPASS_CHECKS|skip validation)"; then
    echo "‚ùå CRITICAL ERROR: Bypass attempt detected in commit message!"
    echo "‚ùå ABSOLUTE PROHIBITION: --no-verify is FORBIDDEN at all costs"
    echo "‚ùå NO EXCEPTIONS - NOT EVEN WITH USER PERMISSION"
    echo ""
    echo "üîí ENFORCEMENT: Commit blocked - Remove bypass references from commit message"
    echo "üìã REQUIRED: Fix all issues and commit without bypassing"
    echo "üìã RULE VIOLATION: This violates Zero Bypassing Tolerance"
    echo ""
    exit 1
fi

# Check for attempts to describe bypassing in commit message
if echo "$commit_msg" | grep -qiE "(bypass.*hook|skip.*pre-commit|no.*verify|ignore.*validation)"; then
    echo "‚ö†Ô∏è  WARNING: Commit message contains bypass-related keywords"
    echo "‚ö†Ô∏è  If this is intentional documentation, please rephrase"
    echo "‚ö†Ô∏è  Otherwise, remove bypass-related content from commit message"
    echo ""
    # Don't block, just warn - in case someone is documenting the protection
fi

echo "‚úÖ Commit message validation passed"

